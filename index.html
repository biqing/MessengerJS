<!DOCTYPE html>
<head>
	<meta charset='utf-8'>
	<meta http-equiv="X-UA-Compatible" content="chrome=1">
	<link type="text/css" href="css/index.css" media="screen" />
		<!--[if lt IE 9]>
		<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<title>Messengerjs</title>
	<script type="text/javascript">
		(function (ie){if(!ie)return;var b=document.createElement("script");b.setAttribute("type","text/javascript");b.setAttribute("src","http://"+location.hostname+"/firebug-lite/build/firebug-lite.js");document.getElementsByTagName("head")[0].appendChild(b)}(!+"\v1")); 
	</script> 
	</head>
	<body>
		<div id="mes">
			<input type="text" event-input="{{'Event.send'}}" attr-value="{{postdata}}" bind-form="{{'postdata'}}">
			<div><b>your data:</b>{{postdata}}</div>
			<hr>
			<div>
				<h2>In new Window</h2>
				<input type="button" value="create new Window" attr-event-click="{{'Event.addWindow'}}">
			</div>
			<div id="iframes">
				<h2>In new Iframe</h2>
				<input type="button" value="create new Iframe" attr-event-click="{{'Event.addIframe'}}">
			</div>
		</div>
	</body>
	<!-- // <script src="js/messenger.min.js"></script> -->
	<script src="src/messenger.js"></script>
	<script src="js/HTML-ViewParse.debug.js"></script>
	<script type="text/javascript">
		ViewParser.ready(function() {
			messenger = new Messenger('parent');

			ViewParser.app({ //create Mes_App
				Id: "mes",
				Var: "Mes_App",
				Data: {
					postdata: "write something",
					// Windows:[],
					Event: {
						send: function(e, vi) { //vi === Mes_App
							console.log("send:", vi.get("postdata"))
							messenger.send(vi.get("postdata"));
						},
						addWindow: function() {
							var newWindow = window.open("window1.html", "_blank", "toolbar=no, location=yes, directories=no, status=no, menubar=yes, scrollbars=no, resizable=no, copyhistory=yes, width=400, height=120")
							messenger.add(newWindow, "window1");
						},
						addIframe: function() {
							var newIframe = document.createElement("iframe");
							newIframe.height = 120;
							newIframe.width = "100%";
							newIframe.src = "iframe1.html";
							newIframe.frameborder = 0;
							newIframe.name = "mes_iframes";
							document.getElementById('iframes').appendChild(newIframe);
							messenger.add(newIframe, "iframe1")
						}
					}
				}
			});
			messenger.listen(function(msg) {
				console.log("get:", msg)
				Mes_App.set("postdata", msg);
			});
		})
	</script> 
	<script defer="defer">
	

	</script>
</html>